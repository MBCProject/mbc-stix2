{
    "type": "bundle",
    "id": "bundle--a8a44195-be2a-4ca4-88cc-9d5d4d4a0986",
    "objects": [
        {
            "type": "malware-behavior",
            "spec_version": "2.1",
            "id": "malware-behavior--1fe2139c-f332-42ba-833c-df479946d81f",
            "created_by_ref": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
            "created": "2019-08-01T00:00:00.000Z",
            "modified": "2023-09-13T00:00:00.000Z",
            "name": "Debugger Evasion",
            "obj_defn": {
                "description": "Debugger evasion is employed by malware to foil a debugger and avoid analysis. For example, to hinder the malware analyst and debugger, malware may use exception handling to execute non-obvious execution paths (exception misdirection method) or may use several parallel threads (parallel threads method). Additional debugger evasion methods are described below.\n\nA thorough reference for anti-debugging, both detection and evasion, is given in [1].\n\nThe related **Debugger Evasion ([T1622](https://attack.mitre.org/techniques/T1622/))** ATT&CK technique was defined subsequent to this MBC behavior.",
                "external_id": "B0002",
                "source_name": "mitre-mbc",
                "url": "https://github.com/MBCProject/mbc-markdown/blob/main/anti-behavioral-analysis/debugger-evasion.md"
            },
            "tags": {
                "Anti-Analysis-Type": "Evasion"
            },
            "objective_refs": [
                "malware-objective--f38b4e5f-7c1b-4c17-9610-a739550ab918"
            ],
            "detection_rules": [
                {
                    "api_fncs": [
                        "NtSetInformationThread",
                        "ZwSetInformationThread",
                        "GetCurrentThread"
                    ],
                    "detect_ref": "malware-behavior--1fe2139c-f332-42ba-833c-df479946d81f",
                    "rule_name": "hide thread from debugger",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-debugging/debugger-evasion/hide-thread-from-debugger.yml"
                },
                {
                    "api_fncs": [
                        "user32.CreateDesktop",
                        "user32.SwitchDesktop"
                    ],
                    "detect_ref": "malware-behavior--1fe2139c-f332-42ba-833c-df479946d81f",
                    "rule_name": "switch active desktop",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/gui/switch-active-desktop.yml"
                }
            ],
            "obj_version": "2.0",
            "related_object_refs": [
                "attack-pattern--e4dc8c01-417f-458d-9ee0-bb0617c1b391"
            ],
            "external_references": [
                {
                    "source_name": "ferrie",
                    "description": "P. Ferrie, \"The Ultimate Anti-Debugging Reference,\" May 4, 2011 [Online].",
                    "url": "https://anti-reversing.com/Downloads/Anti-Reversing/The_Ultimate_Anti-Reversing_Reference.pdf"
                },
                {
                    "source_name": "synack",
                    "description": "\"Analyzing the Anti-Analysis Logic of an Adware Installer,\" Synack, Feb. 2, 2016.",
                    "url": "https://objective-see.org/blog/blog_0x0C.html"
                },
                {
                    "source_name": "fireeye-vmaware",
                    "description": "\"The Dead Giveaways of VM-Aware Malware,\" FireEye, Jan 2011.",
                    "url": "https://web.archive.org/web/20160927120026/https://www.fireeye.com/blog/threat-research/2011/01/the-dead-giveaways-of-vm-aware-malware.html"
                },
                {
                    "source_name": "sonicwall",
                    "description": "\"Revisiting Vobfus Worm,\" SonicWALL, Mar. 8, 2013 [Online].",
                    "url": "https://securitynews.sonicwall.com/xmlpost/revisiting-vobfus-worm-mar-8-2013/"
                }
            ],
            "object_marking_refs": [
                "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3"
            ],
            "extensions": {
                "extension-definition--d57b7c9c-7fa6-436b-b82c-8e6f69cdc3d0": {
                    "extension_type": "new-sdo"
                }
            }
        }
    ]
}