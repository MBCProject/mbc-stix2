{
    "type": "bundle",
    "id": "bundle--a8ec4c7b-7bdb-4110-9a92-944b2028d9f9",
    "objects": [
        {
            "type": "malware-behavior",
            "spec_version": "2.1",
            "id": "malware-behavior--27a92199-2b4a-4f46-b18d-d2abf34bb478",
            "created_by_ref": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
            "created": "2019-08-01T00:00:00.000Z",
            "modified": "2023-09-13T00:00:00.000Z",
            "name": "Process Injection",
            "obj_defn": {
                "description": "Malware may execute code in the address space of a separate process. \n\nSee ATT&CK: **Process Injection ([T1055](https://attack.mitre.org/techniques/T1055/), [T1631](https://attack.mitre.org/techniques/T1631/))**.\n\nThe methods table includes existing ATT&CK sub-techniques, which have been enhanced with malware-specific details, as well as new methods. Note that IAT hooking and inline hooking (aka userland rootkits) are defined as methods under the [Hijack Execution Flow](https://github.com/MBCProject/mbc-markdown/blob/main/defense-evasion/hijack-execution-flow.md) behavior.",
                "external_id": "E1055",
                "source_name": "mitre-mbc",
                "url": "https://github.com/MBCProject/mbc-markdown/blob/main/defense-evasion/process-injection.md"
            },
            "objective_refs": [
                "malware-objective--debfe6b5-b30d-429f-aa74-b416af866f7b",
                "malware-objective--84875b35-71e1-445d-bd40-0fb23e5b9e1c"
            ],
            "detection_rules": [
                {
                    "api_fncs": [
                        "VirtualProtect",
                        "GetProcAddress",
                        "ReadProcessMemory"
                    ],
                    "detect_ref": "malware-method--1a40603f-4a1a-4c2c-a2c2-62019ffe1557",
                    "rule_name": "patch process command line",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/anti-analysis/anti-forensic/patch-process-command-line.yml"
                },
                {
                    "api_fncs": [
                        "ntoskrnl.KeStackAttachProcess",
                        "ntoskrnl.KeUnstackDetachProcess"
                    ],
                    "detect_ref": "malware-behavior--27a92199-2b4a-4f46-b18d-d2abf34bb478",
                    "rule_name": "attach user process memory",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/process/inject/attach-user-process-memory.yml"
                },
                {
                    "api_fncs": [
                        "SetWindowLong",
                        "SetWindowLongPtr",
                        "PostMessage",
                        "SendNotifyMessage"
                    ],
                    "detect_ref": "malware-behavior--27a92199-2b4a-4f46-b18d-d2abf34bb478",
                    "rule_name": "inject shellcode using extra window memory",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/process/inject/inject-shellcode-using-extra-window-memory.yml"
                },
                {
                    "api_fncs": [
                        "CreateFileMapping",
                        "MapViewOfFile",
                        "MapViewOfFileNuma2"
                    ],
                    "detect_ref": "malware-behavior--27a92199-2b4a-4f46-b18d-d2abf34bb478",
                    "rule_name": "inject shellcode using a file mapping object",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/process/inject/inject-shellcode-using-a-file-mapping-object.yml"
                },
                {
                    "api_fncs": [
                        "user32.SetProp",
                        "PostMessage",
                        "SendNotifyMessage"
                    ],
                    "detect_ref": "malware-behavior--27a92199-2b4a-4f46-b18d-d2abf34bb478",
                    "rule_name": "inject shellcode using window subclass procedure",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/process/inject/inject-shellcode-using-window-subclass-procedure.yml"
                },
                {
                    "api_fncs": [
                        "ConvertThreadToFiber",
                        "CreateFiber",
                        "SwitchToFiber"
                    ],
                    "detect_ref": "malware-method--1a40603f-4a1a-4c2c-a2c2-62019ffe1557",
                    "rule_name": "execute shellcode via Windows fibers",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/load-code/shellcode/execute-shellcode-via-windows-fibers.yml"
                }
            ],
            "obj_version": "2.0",
            "related_object_refs": [
                "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d",
                "attack-pattern--b7c0e45f-0206-4f75-96e7-fe7edad3aaff"
            ],
            "external_references": [
                {
                    "source_name": "hosseini",
                    "description": "A. Hosseini, \"Ten Process Injection Techniques: A Technical Survey of Common and Trending Process Injection Techniques,\" Elastic, blog, Jul. 18, 2017 [Online].",
                    "url": "https://www.elastic.co/blog/ten-process-injection-techniques-technical-survey-common-and-trending-process"
                },
                {
                    "source_name": "fireeye-poisonivy",
                    "description": "\"Poison Ivy: Assessing Damange and Extracting Intelligence,\" FireEye, Special Report, 2014 [Online].",
                    "url": "https://www.mandiant.com/sites/default/files/2021-09/rpt-poison-ivy.pdf"
                },
                {
                    "source_name": "lordnoteworthy",
                    "description": "A. Faouzi (LordNoteworthy), \"README.md,\" Al-Khaser v0.81. Accessed Apr. 29, 2023 [Online].",
                    "url": "https://github.com/LordNoteworthy/al-khaser"
                },
                {
                    "source_name": "citizen lab",
                    "description": "M. Brooks, J. Dalek, and M. Crete-Nishihata, \"Between Hong Kong and Burma: Tracking UP007 and SLServer Espionage Campaigns,\" The Citizen Lab, Apr. 18, 2016 [Online].",
                    "url": "https://docs.microsoft.com/en-us/windows/win32/winmsg/about-hooks?redirectedfrom=MSDN#hook-procedures"
                },
                {
                    "source_name": "readteamnotes",
                    "description": "Red Team Notes, \"Shellcode Execution through Fibers\" [Online].",
                    "url": "https://www.ired.team/offensive-security/code-injection-process-injection/executing-shellcode-with-createfiber"
                },
                {
                    "source_name": "sophos-cryptowall",
                    "description": "\"The current state of ransomware: CryptoWall,\" Sophos News, Dec. 17, 2015 [Online].",
                    "url": "https://news.sophos.com/en-us/2015/12/17/the-current-state-of-ransomware-cryptowall/"
                },
                {
                    "source_name": "fsecure-hupigon",
                    "description": "\"Backdoor:W32/Hupigon,\" F-Secure, Threat Description [Online].",
                    "url": "https://www.f-secure.com/v-descs/backdoor_w32_hupigon.shtml"
                },
                {
                    "source_name": "fsecure-quedagh",
                    "description": "\"BlackEnergy & Quedagh: The convergence of crimeware and APT attacks,\" F-Secure Labs [Online].",
                    "url": "https://blog-assets.f-secure.com/wp-content/uploads/2019/10/15163408/BlackEnergy_Quedagh.pdf"
                },
                {
                    "source_name": "falliere-stuxnet",
                    "description": "N. Falliere, L. Murchu, and E. Chien, \"W32.Stuxnet Dossier,\" Symantec Security Response, Feb. 2011 [Online].",
                    "url": "https://docs.broadcom.com/doc/security-response-w32-stuxnet-dossier-11-en"
                },
                {
                    "source_name": "victor-netwalker",
                    "description": "K. Victor, \"Reflective Loading Runs Netwalker Fileless Ransomware,\" Trend Micro, May 18, 2020 [Online].",
                    "url": "https://www.trendmicro.com/en_us/research/20/e/netwalker-fileless-ransomware-injected-via-reflective-loading.html"
                },
                {
                    "source_name": "cybereason-trickbot",
                    "description": "Cybereason Nocturnus, \"Dropping Anchor: From a TrickBot Infection to the Discovery of the Anchor Malware,\" Cybereason, blog, Dec. 11, 2019 [Online].",
                    "url": "https://www.cybereason.com/blog/research/dropping-anchor-from-a-trickbot-infection-to-the-discovery-of-the-anchor-malware"
                },
                {
                    "source_name": "mcafee-webcobra",
                    "description": "\"WebCobra Malware Uses Victims' Computers to Mine Cryptocurrency,\" McAfee, blog, Nov. 12, 2018 [Online].",
                    "url": "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/webcobra-malware-uses-victims-computers-to-mine-cryptocurrency/"
                },
                {
                    "source_name": "capa analysis",
                    "description": "Analysis output, capa 4.0, analyzed at MITRE on Oct. 12, 2022.",
                    "url": "https://github.com/mandiant/capa-rules"
                }
            ],
            "object_marking_refs": [
                "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3"
            ],
            "extensions": {
                "extension-definition--d57b7c9c-7fa6-436b-b82c-8e6f69cdc3d0": {
                    "extension_type": "new-sdo"
                }
            }
        }
    ]
}