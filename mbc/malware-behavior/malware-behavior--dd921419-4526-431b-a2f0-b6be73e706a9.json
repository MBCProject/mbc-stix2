{
    "type": "bundle",
    "id": "bundle--386fa5ae-ad5c-40fd-8fda-41de6930f004",
    "objects": [
        {
            "type": "malware-behavior",
            "spec_version": "2.1",
            "id": "malware-behavior--dd921419-4526-431b-a2f0-b6be73e706a9",
            "created_by_ref": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
            "created": "2020-12-04T00:00:00.000Z",
            "modified": "2023-09-13T00:00:00.000Z",
            "name": "Registry",
            "obj_defn": {
                "description": "Malware modifies the registry.",
                "external_id": "C0036",
                "source_name": "mitre-mbc",
                "url": "https://github.com/MBCProject/mbc-markdown/blob/main/micro-behaviors/operating-system/registry.md"
            },
            "objective_refs": [
                "malware-objective--72210627-ad38-4539-8ee9-c2c2f399df01"
            ],
            "detection_rules": [
                {
                    "api_fncs": [
                        "ORSetValue",
                        "ORSaveHive"
                    ],
                    "detect_ref": "malware-method--59c224f1-595f-432a-b0fe-5ad9a33489d2",
                    "rule_name": "set registry key via offline registry library",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/registry/set-registry-key-via-offline-registry-library.yml"
                },
                {
                    "api_fncs": [
                        "OROpenHive",
                        "OROpenKey"
                    ],
                    "detect_ref": "malware-method--59c224f1-595f-432a-b0fe-5ad9a33489d2",
                    "rule_name": "open registry key via offline registry library",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/registry/open-registry-key-via-offline-registry-library.yml"
                },
                {
                    "api_fncs": [
                        "advapi32.RegEnumKey",
                        "advapi32.RegEnumKeyEx",
                        "advapi32.RegQueryInfoKeyA",
                        "ZwQueryKey",
                        "ZwEnumerateKey",
                        "NtQueryKey",
                        "NtEnumerateKey",
                        "RtlCheckRegistryKey",
                        "SHEnumKeyEx",
                        "SHQueryInfoKey",
                        "SHRegEnumUSKey",
                        "SHRegQueryInfoUSKey",
                        "Microsoft.Win32.RegistryKey::GetSubKeyNames",
                        "Microsoft.Win32.RegistryKey::OpenBaseKey",
                        "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey",
                        "Microsoft.Win32.RegistryKey::OpenSubKey"
                    ],
                    "detect_ref": "malware-method--59c224f1-595f-432a-b0fe-5ad9a33489d2",
                    "rule_name": "query or enumerate registry key",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/registry/query-or-enumerate-registry-key.yml"
                },
                {
                    "api_fncs": [
                        "advapi32.RegGetValue",
                        "advapi32.RegEnumValue",
                        "advapi32.RegQueryValue",
                        "advapi32.RegQueryValueEx",
                        "advapi32.RegQueryMultipleValues",
                        "ZwQueryValueKey",
                        "ZwEnumerateValueKey",
                        "NtQueryValueKey",
                        "NtEnumerateValueKey",
                        "RtlQueryRegistryValues",
                        "SHGetValue",
                        "SHEnumValue",
                        "SHRegGetInt",
                        "SHRegGetPath",
                        "SHRegGetValue",
                        "SHQueryValueEx",
                        "SHRegGetUSValue",
                        "SHOpenRegStream",
                        "SHRegEnumUSValue",
                        "SHOpenRegStream2",
                        "SHRegQueryUSValue",
                        "SHRegGetBoolUSValue",
                        "SHRegGetValueFromHKCUHKLM",
                        "SHRegGetBoolValueFromHKCUHKLM",
                        "Microsoft.Win32.RegistryKey::GetValue",
                        "Microsoft.Win32.RegistryKey::GetValueKind",
                        "Microsoft.Win32.RegistryKey::GetValueNames",
                        "Microsoft.Win32.Registry::GetValue"
                    ],
                    "detect_ref": "malware-method--59c224f1-595f-432a-b0fe-5ad9a33489d2",
                    "rule_name": "query or enumerate registry value",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/registry/query-or-enumerate-registry-value.yml"
                },
                {
                    "api_fncs": [
                        "ORGetValue"
                    ],
                    "detect_ref": "malware-method--59c224f1-595f-432a-b0fe-5ad9a33489d2",
                    "rule_name": "query registry key via offline registry library",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/registry/query-registry-key-via-offline-registry-library.yml"
                },
                {
                    "api_fncs": [
                        "ORCreateHive",
                        "ORCreateKey"
                    ],
                    "detect_ref": "malware-method--59c224f1-595f-432a-b0fe-5ad9a33489d2",
                    "rule_name": "create registry key via offline registry library",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/registry/create-registry-key-via-offline-registry-library.yml"
                },
                {
                    "api_fncs": [
                        "advapi32.RegSetValue",
                        "advapi32.RegSetValueEx",
                        "advapi32.RegSetKeyValue",
                        "ZwSetValueKey",
                        "NtSetValueKey",
                        "RtlWriteRegistryValue",
                        "SHSetValue",
                        "SHRegSetPath",
                        "SHRegSetValue",
                        "SHRegSetUSValue",
                        "SHRegWriteUSValue",
                        "Microsoft.Win32.RegistryKey::SetValue",
                        "Microsoft.Win32.Registry::SetValue"
                    ],
                    "detect_ref": "malware-method--59c224f1-595f-432a-b0fe-5ad9a33489d2",
                    "rule_name": "set registry value",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/registry/create/set-registry-value.yml"
                },
                {
                    "api_fncs": [
                        "advapi32.RegDeleteKey",
                        "advapi32.RegDeleteTree",
                        "advapi32.RegDeleteKeyEx",
                        "advapi32.RegDeleteKeyTransacted",
                        "ZwDeleteKey",
                        "NtDeleteKey",
                        "SHDeleteKey",
                        "SHDeleteEmptyKey",
                        "SHRegDeleteEmptyUSKey",
                        "Microsoft.Win32.RegistryKey::DeleteSubKey",
                        "Microsoft.Win32.RegistryKey::DeleteSubKeyTree"
                    ],
                    "detect_ref": "malware-method--59c224f1-595f-432a-b0fe-5ad9a33489d2",
                    "rule_name": "delete registry key",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/registry/delete/delete-registry-key.yml"
                },
                {
                    "api_fncs": [
                        "advapi32.RegDeleteValue",
                        "advapi32.RegDeleteKeyValue",
                        "ZwDeleteValueKey",
                        "NtDeleteValueKey",
                        "RtlDeleteRegistryValue",
                        "SHDeleteValue",
                        "SHRegDeleteUSValue",
                        "Microsoft.Win32.RegistryKey::DeleteValue"
                    ],
                    "detect_ref": "malware-method--59c224f1-595f-432a-b0fe-5ad9a33489d2",
                    "rule_name": "delete registry value",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/host-interaction/registry/delete/delete-registry-value.yml"
                },
                {
                    "api_fncs": [
                        "advapi32.RegOpenKey",
                        "advapi32.RegOpenKeyEx",
                        "advapi32.RegCreateKey",
                        "advapi32.RegCreateKeyEx",
                        "advapi32.RegOpenCurrentUser",
                        "advapi32.RegOpenKeyTransacted",
                        "advapi32.RegOpenUserClassesRoot",
                        "advapi32.RegCreateKeyTransacted",
                        "ZwOpenKey",
                        "ZwOpenKeyEx",
                        "ZwCreateKey",
                        "ZwOpenKeyTransacted",
                        "ZwOpenKeyTransactedEx",
                        "ZwCreateKeyTransacted",
                        "NtOpenKey",
                        "NtCreateKey",
                        "SHRegOpenUSKey",
                        "SHRegCreateUSKey",
                        "RtlCreateRegistryKey",
                        "Microsoft.Win32.RegistryKey::OpenSubKey",
                        "Microsoft.Win32.RegistryKey::OpenBaseKey",
                        "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey",
                        "Microsoft.Win32.RegistryKey::CreateSubKey"
                    ],
                    "detect_ref": "malware-method--59c224f1-595f-432a-b0fe-5ad9a33489d2",
                    "rule_name": "create or open registry key",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/lib/create-or-open-registry-key.yml"
                },
                {
                    "api_fncs": [
                        "advapi32.RegOpenKey",
                        "advapi32.RegOpenKeyEx",
                        "advapi32.RegCreateKey",
                        "advapi32.RegCreateKeyEx",
                        "advapi32.RegOpenCurrentUser",
                        "advapi32.RegOpenKeyTransacted",
                        "advapi32.RegOpenUserClassesRoot",
                        "advapi32.RegCreateKeyTransacted",
                        "ZwOpenKey",
                        "ZwOpenKeyEx",
                        "ZwCreateKey",
                        "ZwOpenKeyTransacted",
                        "ZwOpenKeyTransactedEx",
                        "ZwCreateKeyTransacted",
                        "NtOpenKey",
                        "NtCreateKey",
                        "SHRegOpenUSKey",
                        "SHRegCreateUSKey",
                        "RtlCreateRegistryKey",
                        "Microsoft.Win32.RegistryKey::OpenSubKey",
                        "Microsoft.Win32.RegistryKey::OpenBaseKey",
                        "Microsoft.Win32.RegistryKey::OpenRemoteBaseKey",
                        "Microsoft.Win32.RegistryKey::CreateSubKey"
                    ],
                    "detect_ref": "malware-method--59c224f1-595f-432a-b0fe-5ad9a33489d2",
                    "rule_name": "create or open registry key",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/lib/create-or-open-registry-key.yml"
                }
            ],
            "obj_version": "2.1",
            "external_references": [
                {
                    "source_name": "capa analysis",
                    "description": "Analysis output, capa 4.0, analyzed at MITRE on Oct. 12, 2022.",
                    "url": "https://github.com/mandiant/capa-rules"
                }
            ],
            "object_marking_refs": [
                "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3"
            ],
            "extensions": {
                "extension-definition--d57b7c9c-7fa6-436b-b82c-8e6f69cdc3d0": {
                    "extension_type": "new-sdo"
                }
            }
        }
    ]
}