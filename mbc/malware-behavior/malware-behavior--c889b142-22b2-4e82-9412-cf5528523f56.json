{
    "type": "bundle",
    "id": "bundle--2e1f2404-1fd2-4914-ba75-1b9e1244dadc",
    "objects": [
        {
            "type": "malware-behavior",
            "spec_version": "2.1",
            "id": "malware-behavior--c889b142-22b2-4e82-9412-cf5528523f56",
            "created_by_ref": "identity--b73c59c1-8560-449a-b8d0-c2ce0533c5bf",
            "created": "2020-08-14T00:00:00.000Z",
            "modified": "2023-09-13T00:00:00.000Z",
            "name": "HTTP Communication",
            "obj_defn": {
                "description": "This micro-behavior is related to HTTP communication. \n\nInstead of being listed alphabetically, methods have been grouped to better faciliate labeling and mapping.",
                "external_id": "C0002",
                "source_name": "mitre-mbc",
                "url": "https://github.com/MBCProject/mbc-markdown/blob/main/micro-behaviors/communication/http-communication.md"
            },
            "objective_refs": [
                "malware-objective--5823a1fb-61cd-4484-abfc-adfa88cca816"
            ],
            "detection_rules": [
                {
                    "api_fncs": [
                        "winhttp.WinHttpQueryHeaders"
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "read HTTP header",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/read-http-header.yml"
                },
                {
                    "api_fncs": [
                        "winhttp.WinHttpOpen"
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "initialize WinHTTP library",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/initialize-winhttp-library.yml"
                },
                {
                    "api_fncs": [
                        "ole32.CoCreateInstance"
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "initialize IWebBrowser2",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/initialize-iwebbrowser2.yml"
                },
                {
                    "api_fncs": [
                        "wininet.HttpQueryInfo"
                    ],
                    "detect_ref": "malware-behavior--c889b142-22b2-4e82-9412-cf5528523f56",
                    "rule_name": "get HTTP content length",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/get-http-content-length.yml"
                },
                {
                    "api_fncs": [
                        "winhttp.WinHttpAddRequestHeaders",
                        "System.Net.WebHeaderCollection::Add"
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "set HTTP header",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/set-http-header.yml"
                },
                {
                    "api_fncs": [
                        "urlmon.ObtainUserAgentString"
                    ],
                    "detect_ref": "malware-behavior--c889b142-22b2-4e82-9412-cf5528523f56",
                    "rule_name": "reference HTTP User-Agent string",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/reference-http-user-agent-string.yml"
                },
                {
                    "api_fncs": [
                        "httpapi.HttpInitialize",
                        "httpapi.HttpTerminate",
                        "System.Net.HttpListener::Start"
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "start HTTP server",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/server/start-http-server.yml"
                },
                {
                    "api_fncs": [
                        "httpapi.HttpReceiveHttpRequest",
                        "httpapi.HttpReceiveRequestEntityBody"
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "receive HTTP request",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/server/receive-http-request.yml"
                },
                {
                    "api_fncs": [
                        "httpapi.HttpSendHttpResponse",
                        "httpapi.HttpSendResponseEntityBody"
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "send HTTP response",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/server/send-http-response.yml"
                },
                {
                    "api_fncs": [
                        "System.Net.WebRequest::GetResponse",
                        "winhttp.WinHttpReceiveResponse",
                        "winhttp.WinHttpReadData",
                        "winhttp.WinHttpQueryDataAvailable"
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "receive HTTP response",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/receive-http-response.yml"
                },
                {
                    "api_fncs": [
                        "System.Net.WebRequest::GetResponse",
                        "System.Net.WebRequest::GetResponseAsync",
                        "wininet.HttpOpenRequest",
                        "wininet.InternetConnect",
                        "wininet.HttpSendRequest",
                        "wininet.HttpSendRequestEx",
                        "winhttp.WinHttpSendRequest",
                        "winhttp.WinHttpWriteData",
                        "winhttp.WinHttpOpenRequest",
                        "winhttp.WinHttpConnect"
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "send HTTP request",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/send-http-request.yml"
                },
                {
                    "api_fncs": [
                        "wininet.InternetReadFile",
                        "wininet.InternetReadFileEx",
                        "System.Net.WebClient::DownloadString",
                        "System.Net.WebClient::DownloadStringAsync",
                        "System.Net.WebClient::DownloadStringTaskAsync",
                        "System.Net.WebClient::DownloadData",
                        "System.Net.WebClient::DownloadDataAsync",
                        "System.Net.WebClient::DownloadDataTaskAsync"
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "read data from Internet",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/read-data-from-internet.yml"
                },
                {
                    "api_fncs": [
                        "oleaut32.SysAllocString",
                        "oleaut32.VariantInit"
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "get HTTP document via IWebBrowser2",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/get-http-document-via-iwebbrowser2.yml"
                },
                {
                    "api_fncs": [
                        "oleaut32.SysAllocString",
                        "oleaut32.VariantInit"
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "get HTTP document via IWebBrowser2",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/get-http-document-via-iwebbrowser2.yml"
                },
                {
                    "api_fncs": [
                        "urlmon.URLDownloadToFile",
                        "urlmon.URLDownloadToCacheFile",
                        "urlmon.URLOpenBlockingStream",
                        "urlmon.URLOpenPullStream",
                        "urlmon.URLOpenStream",
                        "System.Net.WebClient::DownloadFile",
                        "System.Net.WebClient::DownloadFileAsync",
                        "System.Net.WebClient::DownloadFileTaskAsync",
                        "Microsoft.VisualBasic.Devices.Network::DownloadFile"
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "download URL",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/download-url.yml"
                },
                {
                    "api_fncs": [
                        "winhttp.WinHttpOpenRequest"
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "prepare HTTP request",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/prepare-http-request.yml"
                },
                {
                    "api_fncs": [
                        "wininet.InternetOpen",
                        "System.Net.WebRequest::Create",
                        "System.Net.WebRequest::CreateDefault",
                        "System.Net.WebRequest::CreateHttp",
                        "wininet.InternetCloseHandle"
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "create HTTP request",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/create-http-request.yml"
                },
                {
                    "api_fncs": [
                        "wininet.InternetWriteFile"
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "send file via HTTP",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/send-file-via-http.yml"
                },
                {
                    "api_fncs": [
                        " "
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "decompress HTTP response via IEncodingFilterFactory",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/decompress-http-response-via-iencodingfilterfactory.yml"
                },
                {
                    "api_fncs": [
                        "atoi",
                        "wininet.HttpQueryInfo"
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "check HTTP status code",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/check-http-status-code.yml"
                },
                {
                    "api_fncs": [
                        "wininet.HttpQueryInfo"
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "get HTTP response content encoding",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/get-http-response-content-encoding.yml"
                },
                {
                    "api_fncs": [
                        "wininet.InternetOpenUrl"
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "connect to URL",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/connect-to-url.yml"
                },
                {
                    "api_fncs": [
                        "wininet.InternetConnect"
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "connect to HTTP server",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/connect-to-http-server.yml"
                },
                {
                    "api_fncs": [
                        " "
                    ],
                    "detect_ref": "malware-method--d20b288c-11cc-48cc-9526-c6cefe7739ee",
                    "rule_name": "extract HTTP body",
                    "rule_type": "capa",
                    "url": "https://github.com/mandiant/capa-rules/blob/master/communication/http/client/extract-http-body.yml"
                }
            ],
            "obj_version": "2.0",
            "external_references": [
                {
                    "source_name": "capa analysis",
                    "description": "Analysis output, capa 4.0, analyzed at MITRE on Oct. 12, 2022.",
                    "url": "https://github.com/mandiant/capa-rules"
                }
            ],
            "object_marking_refs": [
                "marking-definition--093b6375-cd45-4aa3-8f91-6a03ddd7a3d3"
            ],
            "extensions": {
                "extension-definition--d57b7c9c-7fa6-436b-b82c-8e6f69cdc3d0": {
                    "extension_type": "new-sdo"
                }
            }
        }
    ]
}